<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="nertz.css"> <link>
    <link rel="icon" type="image/x-icon" href="../Birb-icon.png">
    <title>Nertz Score Tracker</title>
</head>
<body>
    <div id="home"><a href="../index.html">Back to Home</a></div>
    <h3>Nertz Score Tracker</h3>
    <div>
        <span>Player count:</span>
        <input type="number" id="numPlayers" value=3 min=2 max=9 onchange="updateNumPlayers()"style="width: 2em"></input>
        <script>
            function updateNumPlayers()
            {
                let n = document.getElementById("numPlayers");
                if (n.value < 2)
                    n.value = 2;
                else if (n.value > 9)
                    n.value = 9;
            }
        </script>
    </div>

    <div id="playerTable">
        <button id="startGame" onclick="startGame()">Start Game</button>

        <table id="columns"></table>
        <script>
            function startGame(){
                document.getElementById("startGame").disabled = true;
                let numPlayers = document.getElementById("numPlayers");
                numPlayers.disabled = true

                for(var i = 1; i <= numPlayers.value; i++){
                    let player = document.createElement("th");
                    player.innerHTML = `<input placeholder="Player ${i}"></input>`;
                    player.id = "player"+i;
                    document.getElementById("columns").appendChild(player);

                    let score = document.createElement("tr");
                    score.value = 0;
                    score.innerHTML = "Score: " + score.value;
                    score.id = "score"+i;
                    document.getElementById(player.id).appendChild(score);

                    let input = document.createElement("input");
                    input.id="input"+i;
                    input.type="number"
                    document.getElementById(player.id).appendChild(input);

                    let rounds = document.createElement("div");
                    rounds.id = "rounds"+i
                    document.getElementById(player.id).appendChild(rounds);

                    let add = document.createElement("button");
                    add.innerHTML = "Add Score";
                    add.value = 1;
                    add.onclick = function(){
                        if(input.value != ''){
                            let x = Number(score.value) + Number(input.value);
                            score.value = x;
                            score.innerHTML = "Score: " + x;
                            let roundScore = document.createElement("tr");
                            roundScore.innerHTML = `Round ${add.value++}: ${input.value}`;
                            roundScore.value = input.value;
                            document.getElementById(rounds.id).appendChild(roundScore);
                            input.value = '';
                        }
                    }
                    document.getElementById(player.id).insertBefore(add, rounds);

                    let remove = document.createElement("button");
                    remove.innerHTML = "Remove Last Score";
                    remove.value = 1;
                    remove.onclick = function(){
                        let element = document.getElementById(rounds.id);
                        if(element.firstChild)
                        {
                            let x = Number(element.lastChild.value);
                            element.removeChild(element.lastChild);
                            score.value -= x;
                            score.innerHTML = "Score: " + score.value;
                            add.value--;
                        }
                    }
                    document.getElementById(player.id).insertBefore(remove, rounds);
                }
            }
        </script>
    </div>
</body>
</html>
